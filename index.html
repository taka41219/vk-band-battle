<!DOCTYPE html><html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Vç³»ãƒãƒˆãƒ«ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: linear-gradient(180deg, #0b0b0b, #1a1a1a);
      color: #fff;
      margin: 0;
      padding: 16px;
    }
    h1 { text-align: center; color: #7ecbff; font-size: 1.4rem; }
    .box { background:#111; border-radius:16px; padding:16px; margin-bottom:16px; }
    input { width:100%; font-size:16px; padding:12px; border-radius:12px; border:none; margin-bottom:8px; }
    button { width:100%; padding:14px; font-size:18px; border-radius:20px; border:none; background:linear-gradient(90deg,#5fa9ff,#9b6bff); color:#fff; font-weight:bold; margin-bottom:12px; }
    .sub { background:#444; font-size:14px; }
    .log { background:#000; border-radius:16px; padding:16px; white-space:pre-line; }
    ul { padding-left:18px; }
    .admin { background:#300; margin-top:8px; padding:8px; border-radius:8px; }
    .del { color:#ff7777; cursor:pointer; margin-left:8px; }
  </style>
</head>
<body>
<h1>ğŸ¸ ãƒ´ã‚£ã‚¸ãƒ¥ã‚¢ãƒ«ç³»ãƒãƒ³ãƒ‰<br>æˆ¦é—˜åŠ›ãƒãƒˆãƒ« ğŸ¸</h1><div class="box">
  <h2>ğŸ–¤ ã‚ãªãŸã®ãƒãƒ³ãƒ‰</h2>
  <input id="player" placeholder="ãƒãƒ³ãƒ‰åã‚’å…¥åŠ›" />
</div>
<div class="box">
  <h2>ğŸ’€ å¯¾æˆ¦ãƒãƒ³ãƒ‰</h2>
  <input id="cpu" placeholder="CPUãƒãƒ³ãƒ‰åã‚’å…¥åŠ›" />
</div>
<button onclick="battle()">ğŸ”¥ ãƒãƒˆãƒ«é–‹å§‹ ğŸ”¥</button>
<button class="sub" onclick="retire()">ğŸ³ï¸ ãƒªã‚¿ã‚¤ãƒ¤ã—ã¦è¨˜éŒ²ã™ã‚‹</button><div class="box log" id="result">ã“ã“ã«çµæœãŒè¡¨ç¤ºã•ã‚Œã‚‹â€¦</div><div class="box">
  <h2>ğŸ† æˆ¦é—˜åŠ›ãƒ©ãƒ³ã‚­ãƒ³ã‚°ï¼ˆä¸Šä½5ï¼‰</h2>
  <ul id="ranking"></ul>
</div><div class="box">
  <h2>ğŸ”¥ é€£å‹ãƒ©ãƒ³ã‚­ãƒ³ã‚°ï¼ˆä¸Šä½5ï¼‰</h2>
  <ul id="streakRank"></ul>
</div><div class="box admin">
  <h2>ğŸ”‘ ç®¡ç†äººãƒ¢ãƒ¼ãƒ‰</h2>
  <input id="adminPass" placeholder="ç®¡ç†äººãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰" />
  <button onclick="adminLogin()">ç®¡ç†äººãƒ­ã‚°ã‚¤ãƒ³</button>
</div><script>
  const ADMIN_PASSWORD = 'admin123';
  let isAdmin = false;

  function calcPower(name) {
    let power = 0;
    for (let i = 0; i < name.length; i++) power += name.charCodeAt(i);
    if (name.match(/[ã‚›ãƒ¼]/)) power += 500;
    return power % 10000 + 1000;
  }

  function load(key) {
    return JSON.parse(localStorage.getItem(key) || '[]');
  }
  function save(key, val) {
    localStorage.setItem(key, JSON.stringify(val));
  }

  function adminLogin() {
    if (adminPass.value === ADMIN_PASSWORD) {
      isAdmin = true;
      alert('ç®¡ç†äººãƒ¢ãƒ¼ãƒ‰ON');
      renderRanking();
      renderStreakRanking();
    } else alert('ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé•ã„ã¾ã™');
  }

  function renderRanking() {
    const ul = document.getElementById('ranking');
    ul.innerHTML = '';
    load('powerRank').forEach((r,i)=>{
      const li = document.createElement('li');
      li.innerHTML = `${i+1}ä½ï¼š${r.band} / ${r.user}ï¼ˆ${r.power}ï¼‰` + (isAdmin ? `<span class='del' onclick="delPower(${i})">[å‰Šé™¤]</span>` : '');
      ul.appendChild(li);
    });
  }

  function renderStreakRanking() {
    const ul = document.getElementById('streakRank');
    ul.innerHTML = '';
    load('streakRank').forEach((r,i)=>{
      const li = document.createElement('li');
      li.innerHTML = `${i+1}ä½ï¼š${r.band} / ${r.user}ï¼ˆ${r.streak}é€£å‹ï¼‰` + (isAdmin ? `<span class='del' onclick="delStreak(${i})">[å‰Šé™¤]</span>` : '');
      ul.appendChild(li);
    });
  }

  function delPower(i) { const l = load('powerRank'); l.splice(i,1); save('powerRank', l); renderRanking(); }
  function delStreak(i) { const l = load('streakRank'); l.splice(i,1); save('streakRank', l); renderStreakRanking(); }

  function checkAndSaveRecords() {
    const bestPower = Number(localStorage.getItem('bestPower') || 0);
    const bestStreak = Number(localStorage.getItem('bestStreak') || 0);
    if (bestPower === 0 && bestStreak === 0) return;

    const user = prompt('ãƒ©ãƒ³ã‚­ãƒ³ã‚°ç™»éŒ²ï¼ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒãƒ¼ãƒ ã‚’å…¥åŠ›');
    if (!user) return;

    if (bestPower > 0) {
      let pr = load('powerRank');
      pr.push({ band: localStorage.getItem('bestBand'), user, power: bestPower });
      pr.sort((a,b)=>b.power-a.power);
      save('powerRank', pr.slice(0,5));
    }
    if (bestStreak > 0) {
      let sr = load('streakRank');
      sr.push({ band: localStorage.getItem('bestBand'), user, streak: bestStreak });
      sr.sort((a,b)=>b.streak-a.streak);
      save('streakRank', sr.slice(0,5));
    }

    localStorage.removeItem('bestPower');
    localStorage.removeItem('bestStreak');
    renderRanking();
    renderStreakRanking();
  }

  function battle() {
    const p = player.value.trim();
    const c = cpu.value.trim();
    if (!p || !c) return;

    const pPower = calcPower(p);
    const cPower = calcPower(c);
    let streak = Number(localStorage.getItem('streak') || 0);

    let log = `ğŸ–¤ ${p}\næˆ¦é—˜åŠ›ï¼š${pPower}\n\nğŸ’€ ${c}\næˆ¦é—˜åŠ›ï¼š${cPower}\n\n`;

    if (p === c) {
      log += 'âš ï¸ åŒåãƒãƒ³ãƒ‰ã®ãŸã‚è¨˜éŒ²å¯¾è±¡å¤–';
    } else if (pPower > cPower) {
      log += 'ğŸ”¥ å‹åˆ©ï¼';
      streak++;
      localStorage.setItem('streak', streak);
      localStorage.setItem('bestPower', Math.max(pPower, Number(localStorage.getItem('bestPower')||0)));
      localStorage.setItem('bestStreak', Math.max(streak, Number(localStorage.getItem('bestStreak')||0)));
      localStorage.setItem('bestBand', p);
    } else {
      log += 'ğŸ’€ æ•—åŒ—â€¦';
      localStorage.setItem('streak', 0);
      checkAndSaveRecords();
    }

    document.getElementById('result').textContent = log;
  }

  function retire() {
    checkAndSaveRecords();
    localStorage.setItem('streak', 0);
    document.getElementById('result').textContent = 'ğŸ³ï¸ ãƒªã‚¿ã‚¤ãƒ¤ã—ã¾ã—ãŸã€‚è¨˜éŒ²ã‚’ä¿å­˜ã—ã¾ã—ãŸã€‚';
  }

  renderRanking();
  renderStreakRanking();
</script></body>
</html>
